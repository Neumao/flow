# Work Item System Test Cases

## Test Environment Setup

### Users Created for Testing:

1. **SYSADMIN User**: `sysadmin@test.com` / `password123`
2. **ADMIN User**: `admin@test.com` / `password123`
3. **USER User**: `user@test.com` / `password123`
4. **MODERATOR User**: `moderator@test.com` / `password123`

### Work Item States:

- NEW (initial state)
- IN_PROGRESS
- REVIEW
- BLOCKED
- REWORK
- DONE (final state)
- CANCELLED (final state)

---

## Test Case Structure

### Test Case Format:

```
TC-[Role]-[Flow]-[Step]: [Description]
Prerequisites: [Setup requirements]
Steps: [Step-by-step actions]
Expected Result: [Expected outcome]
```

---

## SYSADMIN User Test Cases

### Complete Happy Path Flow

DONE:

```
TC-SYSADMIN-HAPPY-001: Complete work item lifecycle as SYSADMIN
Prerequisites: SYSADMIN user logged in
Steps:
1. Create work item: Title="Test Item 1", Description="Complete flow test"
2. Verify item created with state=NEW
3. Transition: NEW → IN_PROGRESS
4. Update work item: Change title to "Updated Test Item 1"
5. Transition: IN_PROGRESS → REVIEW
6. Transition: REVIEW → DONE
Expected Result: Work item successfully moves through complete lifecycle
```

### Blocking and Unblocking Flow

DONE:

```
TC-SYSADMIN-BLOCK-001: Block and unblock work item
Prerequisites: Work item in REVIEW state
Steps:
1. Block work item with reason: "Waiting for clarification"
2. Verify item state changes to BLOCKED
3. Attempt transition while blocked (should fail)
4. Unblock work item
5. Verify item returns to REVIEW state
6. Complete transition: REVIEW → DONE
Expected Result: Blocking prevents transitions, unblocking allows normal flow
```

### Rework Flow

DONE:

```
TC-SYSADMIN-REWORK-001: Send work item for rework
Prerequisites: Work item in REVIEW state
Steps:
1. Send for rework with justification: "Needs additional requirements"
2. Verify item state changes to REWORK
3. Transition: REWORK → IN_PROGRESS
4. Update work item content
5. Complete flow: IN_PROGRESS → REVIEW → DONE
Expected Result: Rework flow allows item to be sent back and completed
```

### Cancellation Flow

DONE:

```
TC-SYSADMIN-CANCEL-001: Cancel work item from different states
Prerequisites: Multiple work items in different states
Steps:
1. Cancel item in NEW state with justification: "Project cancelled"
2. Cancel item in IN_PROGRESS state with justification: "Requirements changed"
3. Cancel item in REVIEW state with justification: "No longer needed"
4. Verify all items reach CANCELLED state
Expected Result: Cancellation works from any state
```

### Cross-User Operations

DONE:

```
TC-SYSADMIN-CROSS-001: SYSADMIN can operate on any user's work items
Prerequisites: Work items created by different users
Steps:
1. Login as USER, create work item
2. Login as SYSADMIN
3. Update the USER's work item
4. Block the USER's work item
5. Transition the USER's work item through states
6. Cancel the USER's work item
Expected Result: SYSADMIN has full access to all work items
```

---

## ADMIN User Test Cases

### Complete Happy Path Flow

DONE:

```
TC-ADMIN-HAPPY-001: Complete work item lifecycle as ADMIN
Prerequisites: ADMIN user logged in
Steps:
1. Create work item: Title="Admin Test Item", Description="Admin flow test"
2. Transition through: NEW → IN_PROGRESS → REVIEW → DONE
3. Update work item during IN_PROGRESS state
Expected Result: ADMIN can perform all work item operations
```

### User Management Operations

```
TC-ADMIN-USER-001: ADMIN can manage USER work items
Prerequisites: USER has created work items
Steps:
1. Login as USER, create work item
2. Login as ADMIN
3. Update USER's work item
4. Block and unblock USER's work item
5. Send USER's work item for rework
6. Cancel USER's work item
Expected Result: ADMIN has full control over USER work items
```

### Moderator Management

```
TC-ADMIN-MOD-001: ADMIN can manage MODERATOR operations
Prerequisites: Work item in REVIEW state
Steps:
1. Login as ADMIN
2. Send work item for rework (MODERATOR permission)
3. Block work item (ADMIN permission)
4. Unblock work item (MODERATOR permission)
Expected Result: ADMIN inherits all permissions
```

---

## USER Role Test Cases

### Own Work Item Management

```
TC-USER-OWN-001: USER can manage their own work items
Prerequisites: USER logged in
Steps:
1. Create work item: Title="My Work Item", Description="User test"
2. Update work item title and description
3. Transition: NEW → IN_PROGRESS
4. Block work item with reason
5. Unblock work item
6. Complete flow: IN_PROGRESS → REVIEW → DONE
Expected Result: USER has full control over own items
```

### Cannot Access Others' Items

```
TC-USER-OTHER-001: USER cannot access other users' work items
Prerequisites: Multiple users have work items
Steps:
1. Login as USER1, create work item
2. Login as USER2
3. Attempt to view USER1's work item (should be denied)
4. Attempt to update USER1's work item (should be denied)
5. Attempt to transition USER1's work item (should be denied)
Expected Result: USER can only access their own work items
```

### Cancellation Rights

```
TC-USER-CANCEL-001: USER can cancel own work items
Prerequisites: USER has work items in various states
Steps:
1. Cancel work item in NEW state
2. Cancel work item in IN_PROGRESS state
3. Cancel work item in REVIEW state
Expected Result: USER can cancel own items from any state
```

### Blocking Own Items

```
TC-USER-BLOCK-001: USER can block/unblock own items
Prerequisites: USER has work item in IN_PROGRESS state
Steps:
1. Block work item with reason: "Need more information"
2. Verify blocking prevents transitions
3. Unblock work item
4. Complete normal flow
Expected Result: USER can block/unblock own items
```

---

## MODERATOR Role Test Cases

### Review and Rework Operations

```
TC-MOD-REVIEW-001: MODERATOR can send items for rework
Prerequisites: Work item in REVIEW state
Steps:
1. Login as MODERATOR
2. Send work item for rework with justification: "Code review failed"
3. Verify item moves to REWORK state
Expected Result: MODERATOR can initiate rework
```

### Unblocking Operations

```
TC-MOD-UNBLOCK-001: MODERATOR can unblock items
Prerequisites: Work item in BLOCKED state
Steps:
1. Login as MODERATOR
2. Unblock work item
3. Verify item returns to previous state
4. Complete normal flow
Expected Result: MODERATOR can unblock items
```

### Transition Permissions

```
TC-MOD-TRANSITION-001: MODERATOR can perform state transitions
Prerequisites: Work items in various states
Steps:
1. Transition item: NEW → IN_PROGRESS
2. Transition item: IN_PROGRESS → REVIEW
3. Transition item: REVIEW → DONE
4. Transition item: REWORK → IN_PROGRESS
Expected Result: MODERATOR can perform allowed transitions
```

### Cannot Create or Edit

```
TC-MOD-LIMITED-001: MODERATOR cannot create or edit work items
Prerequisites: MODERATOR logged in
Steps:
1. Attempt to create new work item (should be denied)
2. Attempt to edit existing work item (should be denied)
3. Attempt to cancel work item (should be denied)
Expected Result: MODERATOR has limited permissions
```

---

## Edge Cases and Error Scenarios

### Invalid Transitions

```
TC-EDGE-INVALID-001: Invalid state transitions are rejected
Prerequisites: Work item in NEW state
Steps:
1. Attempt transition: NEW → DONE (invalid)
2. Attempt transition: NEW → REWORK (invalid)
3. Verify transitions are rejected with appropriate error messages
Expected Result: Invalid transitions are prevented
```

### Blocked Item Transitions

```
TC-EDGE-BLOCKED-001: Blocked items cannot transition
Prerequisites: Work item in BLOCKED state
Steps:
1. Attempt any transition while blocked
2. Verify all transitions are rejected
3. Unblock item first
4. Then perform valid transition
Expected Result: Blocking prevents all transitions
```

### Authorization Failures

```
TC-EDGE-AUTH-001: Authorization failures return proper errors
Prerequisites: USER work item
Steps:
1. Login as different USER
2. Attempt to update other user's work item
3. Attempt to block other user's work item
4. Attempt to cancel other user's work item
5. Verify all operations return authorization errors
Expected Result: Proper authorization error messages
```

### Concurrent Updates

```
TC-EDGE-CONCURRENT-001: Handle concurrent work item updates
Prerequisites: Work item being edited by multiple users
Steps:
1. User A starts editing work item
2. User B updates same work item
3. User A attempts to save changes
4. Verify proper conflict resolution or error handling
Expected Result: Concurrent updates handled gracefully
```

### Network Errors

```
TC-EDGE-NETWORK-001: Handle network connectivity issues
Prerequisites: Unstable network connection
Steps:
1. Perform work item operation during network interruption
2. Verify proper error handling and retry mechanisms
3. Ensure data integrity maintained
Expected Result: Network issues handled gracefully
```

---

## State Transition Matrix Validation

### Happy Path Validations

```
TC-MATRIX-VALID-001: Validate all valid state transitions
Prerequisites: Work items in each state
Steps:
1. NEW → IN_PROGRESS ✓
2. NEW → CANCELLED ✓
3. IN_PROGRESS → REVIEW ✓
4. IN_PROGRESS → CANCELLED ✓
5. REVIEW → DONE ✓
6. REVIEW → REWORK ✓
7. REVIEW → BLOCKED ✓
8. REVIEW → CANCELLED ✓
9. REWORK → IN_PROGRESS ✓
10. REWORK → CANCELLED ✓
11. BLOCKED → IN_PROGRESS (after unblock) ✓
Expected Result: All documented transitions work correctly
```

### Invalid Transition Validations

```
TC-MATRIX-INVALID-001: Validate all invalid state transitions
Prerequisites: Work items in each state
Steps:
1. NEW → REVIEW ✗
2. NEW → DONE ✗
3. NEW → REWORK ✗
4. NEW → BLOCKED ✗
5. IN_PROGRESS → DONE ✗
6. IN_PROGRESS → REWORK ✗
7. IN_PROGRESS → BLOCKED ✗
8. REVIEW → IN_PROGRESS ✗
9. REWORK → REVIEW ✗
10. REWORK → DONE ✗
11. REWORK → BLOCKED ✗
12. BLOCKED → any state while blocked ✗
13. DONE → any state ✗
14. CANCELLED → any state ✗
Expected Result: All invalid transitions are properly rejected
```

---

## Data Integrity Tests

### Audit Trail Validation

```
TC-AUDIT-001: Validate audit trail completeness
Prerequisites: Work item with complete history
Steps:
1. Create work item
2. Perform multiple state transitions
3. Block and unblock item
4. Send for rework
5. Check audit trail contains all events
6. Verify timestamps are correct
7. Verify user attribution is correct
Expected Result: Complete audit trail maintained
```

### Data Consistency

```
TC-DATA-001: Validate data consistency across operations
Prerequisites: Work item undergoing multiple operations
Steps:
1. Create work item with initial data
2. Update work item multiple times
3. Perform state transitions
4. Block/unblock operations
5. Verify data remains consistent
6. Check timestamps update correctly
Expected Result: Data integrity maintained throughout lifecycle
```

---

## Performance Tests

### Bulk Operations

```
TC-PERF-001: Handle multiple work items efficiently
Prerequisites: Multiple work items created
Steps:
1. Create 10+ work items
2. Perform bulk state transitions
3. Update multiple items
4. Verify UI performance remains acceptable
Expected Result: System handles multiple items efficiently
```

### History Loading

```
TC-PERF-002: Handle work items with extensive history
Prerequisites: Work item with many state changes
Steps:
1. Create work item
2. Perform 20+ state transitions with justifications
3. Load work item details
4. Verify history loads efficiently
Expected Result: History loading performs well
```

---

## Test Execution Checklist

### Pre-Execution Setup:

- [ ] Create all 4 test users with correct roles
- [ ] Verify authentication system works
- [ ] Confirm database is clean
- [ ] Ensure all API endpoints are accessible

### Execution Order:

1. [ ] Run SYSADMIN test cases first (baseline)
2. [ ] Run ADMIN test cases
3. [ ] Run USER test cases
4. [ ] Run MODERATOR test cases
5. [ ] Run edge case and error scenarios
6. [ ] Run state transition matrix validations
7. [ ] Run data integrity tests
8. [ ] Run performance tests

### Post-Execution:

- [ ] Verify all test cases pass
- [ ] Document any failures or issues
- [ ] Confirm audit trails are complete
- [ ] Validate data consistency
- [ ] Check for any side effects or unexpected behavior

---

## Test Case Coverage Summary

**Total Test Cases:** 25+
**States Covered:** All 7 states
**Roles Covered:** All 4 roles
**Operations Covered:** Create, Update, Block, Unblock, Rework, Transitions, Cancel
**Edge Cases Covered:** Authorization, Invalid transitions, Concurrency, Network issues
**Validation Areas:** UI, API, Data integrity, Audit trails, Performance
